<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
	<title>Systo</title>
	<style type="text/css" media="screen">
        body {margin:0px; }

		#container
		{
			width: 100%;
			margin: 0px auto;
			background-color: #fff;
			color: #333;
			border: 1px solid gray;
			line-height: 130%;
            font-family: sans-serif;
            font-size: 15px;
		}
		
		#top
		{
			padding: .5em;
			background-color: #ddd;
			border-bottom: 1px solid gray;
		}
		
		#top h1
		{
			padding: 0;
			margin: 0;
		}
		
		#leftnav
		{
			float: left;
			width: 120px;
			margin: 0;
			padding: 1em;
		}
		
		#rightnav
		{
			float: right;
			width: 150px;
			margin: 0;
			padding: 1em;
		}
		
		#content
		{
			margin-left: 130px;
			border-left: 1px solid gray;
			margin-right: 180px;
			border-right: 1px solid gray;
			padding: 1em;
		}
		
		#footer
		{
			clear: both;
			margin: 0;
			padding: .5em;
			color: #333;
			background-color: #ddd;
			border-top: 1px solid gray;
		}
		
		#leftnav p, #rightnav p { margin: 0 0 1em 0; }
		#content h2 { margin: 0 0 .5em 0; }
</style> 
    <!-- CSS -->
    <link type="text/css" rel="stylesheet" href="jquery-ui.css"/>
    <link type="text/css" rel="stylesheet" href="jquery-ui-1.9.2.custom.css"/>

    <!-- Systo core - defines the SYSTO global variable and some core functions -->
    <script type="text/javascript" src="systo.js"></script>

    <!-- Core libraries -->
    <script type="text/javascript" src="jquery-1.10.2.js"></script>
    <script type="text/javascript" src="jquery-ui-1.10.3.js"></script>
	<script type="text/javascript" src="jquery.layout-latest.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="formatting.js"></script>
    <script type="text/javascript" src="Blob.js"></script>
    <script type="text/javascript" src="FileSaver.js"></script>

    <!-- Supplementary Systo code -->
    <!--script type="text/javascript" src="generate_simulation_code_v1.js"></script-->
    <script type="text/javascript" src="simulation.js"></script>
    <script type="text/javascript" src="action.js"></script>
    <script type="text/javascript" src="equation.js"></script>
    <script type="text/javascript" src="functions.js"></script>
    <script type="text/javascript" src="plugins/codeGenerator/euler1.js"></script>
    <script type="text/javascript" src="plugins/codeGenerator/euler2.js"></script>
    <script type="text/javascript" src="plugins/codeGenerator/rk41.js"></script>
    <script type="text/javascript" src="plugins/codeGenerator/euler1animate.js"></script>

    <!-- Model language definition(s), held as a Javascript object literal -->
    <script type="text/javascript" src="languages/system_dynamics.js"></script>

    <!-- Model(s), held as a Javascript object literal -->
    <script type="text/javascript" src="models/predator_prey_shodor.js"></script>

    <!-- The widgets used in this page -->
	<script type="text/javascript" src="systo_widgets/jquery.diagram.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.dialog_sd_node.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.equation_listing.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.inline_value.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.multiple_sliders1.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.plotter.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.scenarios.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.slider1.js"></script>


    <!-- This page's custom script -->
    <script>
        $(document).ready(function() {

            //generateSimulationFunction(SYSTO.models['predator_prey_shodor']);
            SYSTO.switchToModel('predator_prey_shodor');

           $('#plotter1').plotter({
                modelId:'predator_prey_shodor',
                colours:['red', 'blue'],
                canvasWidth:400, 
                canvasHeight:250,
                selectNode:function (node) {
                    var nodesToPlot = {Prey_population:true, Predator_population:true};
                    if (nodesToPlot[node.label]) {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            // TODO: Find out why zoom buttons appear only in correct position when ".resizable()" is added.  
            // When it's not added, the buttons are at the top-left of the window!  Seems very odd.
            $('#diagram1').diagram({
                modelId:'predator_prey_shodor', 
                canvasWidth:420, 
                canvasHeight:330, 
                scale:1, 
                offsetx:-80, 
                offsety:0,
                includeNode:function (node) {
                    if (node.type !== 'variable') {
                        return true;
                    } else {
                        return false;
                    }
                },
                includeArc:function (arc) {
                    if (arc.type === 'flow') {
                        return true;
                    } else {
                        return false;
                    }
                }
            }).
            resizable();

            $('#sliders_initialstock').multiple_sliders1({
                modelId:'predator_prey_shodor',
                selectNode:function (node) {
                    if (node.type === 'stock') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#sliders_parameter').multiple_sliders1({
                modelId:'predator_prey_shodor',
                selectNode:function (node) {
                    if (node.type === 'variable') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#inline_value1').inline_value({modelId:'predator_prey_shodor', nodeId:'stock1', statistic:'max'});
            $('#inline_value2').inline_value({modelId:'predator_prey_shodor', nodeId:'stock2', statistic:'max'});
            $('#inline_value3').inline_value({modelId:'predator_prey_shodor', nodeId:'stock2', statistic:'period'});

            $('#scenarios').scenarios({packageId:'package1', modelId:'predator_prey_shodor'});


            SYSTO.trigger(
                'index.html',
                '',
                'change_model_listener',
                'click',
                [{packageId:'package1', oldModelId:'',newModelId:'predator_prey_shodor'}]);
            SYSTO.trigger(
                'index.html',
                '',
                'display_listener',
                'click',
                [{packageId:'package1', modelId:'predator_prey_shodor'}]);
         });

        function toggleDiagram() {
            if ($('#toggleDiagramButton').text() === 'Show all') {
                $('#diagram1').
                    diagram('option', 'includeNode', function(node) {return true;}).
                    diagram('option', 'includeArc', function(arc) {return true;});  
                $('#toggleDiagramButton').text('Show stocks and flows only');
            } else {
                $('#diagram1').
                    diagram('option', 'includeNode', function(node) {
                        if (node.type !== 'variable') {
                            return true;
                        } else {
                            return false;
                        }
                    }).
                    diagram('option', 'includeArc', function(arc) {
                        if (arc.type === 'flow') {
                            return true;
                        } else {
                            return false;
                        }
                    });  
                $('#toggleDiagramButton').text('Show all');
            }
        }          
    </script>
</head>

<body>
<div id="container">
	<div id="top">
		<h1>Systo</h1>
        <p>Open toolkit for systems modelling</p>
	</div>
	<div id="leftnav">
		<p>
            About<br/>
            <a href="demos.html">Demos</a><br/>
            <a href="languages.html">Languages</a><br/>
            <a href="widgets.html">Widgets</a><br/>
            <a href="models.html">Models</a><br/>
            <a href="systolite.html">SystoLite</a><br/>
            Guide<br/>
            Code repository<br/>
            Contact
		</p>
	</div>
	<div id="rightnav">
<p>
<b>News</b><br/>
13 Sept 2013<br/>
Systo web site goes live.
</p>
<p>
<b>Featured web page</b><br/>
<a href="miniworld.html">Miniworld</a>
</p>
<b>Featured model</b><br/>
<a href="glycolysis.html">Glycolysis</a> (biological pathway)
</p>
<b>Featured widget</b><br/>
<a href="miniworld.html#equation_listing">Equation listing</a><br.>
A very basic widget - a good starting point for aspiring Systo developers.
</p>
	</div>
	<div id="content">
<div style="clear:left">
    <button id="toggleDiagramButton" onclick="toggleDiagram();">Show all</button>
    <br clear="all"/>
    <div id="diagram1" style="float:left; clear:all; border:1px solid gray; margin:5px; width:420px; height:330px;"></div>
</div>
    <div id="sliders_initialstock" style="float:left; padding:7px; margin:1px; width:420px;"></div>
    <div id="sliders_parameter" style="float:left; padding:7px; margin:1px; width:420px;"></div>
    <div id="scenarios" style="float:left; clear:both; padding:7px; margin:1px;"></div>
    <div id="plotter">
        <div id='plotter1' style="position:relative;clear:both;margin:1px; width:400px; height:300px;"></div>
    </div>
</div>

<div id="footer">
Author: Robert Muetzelfeldt<br/>
Last updated: 26 Nov 2014
	</div>
</div>
    <div id="node_dialogs"></div>

    <div id="dialog_sd_node"></div>
<</body>
</html>

