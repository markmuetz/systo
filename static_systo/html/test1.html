<html>
<head>
    <!-- CSS -->
    <link type="text/css" rel="stylesheet" href="jquery-ui.css"/>
    <link type="text/css" rel="stylesheet" href="jquery-ui-1.9.2.custom.css"/>

    <!-- Systo core - defines the SYSTO global variable and some core functions -->
    <script type="text/javascript" src="systo.js"></script>

    <!-- Core libraries -->
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="jquery-ui.min.js"></script>
    <script type="text/javascript" src="jquery-ui-1.8.23.custom.min.js"></script>
    <script type="text/javascript" src="generate_simulation_code.js"></script>
    <script type="text/javascript" src="action.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.ui.widget.js"></script>

    <!-- A model language definition, held as a Javascript object literal -->
    <script type="text/javascript" src="languages/system_dynamics.js"></script>
    <script type="text/javascript" src="languages/wcs_conceptual_modelling.js"></script>

    <!-- Model(s), held as a Javascript object literal -->
    <script type="text/javascript" src="models/miniworld.js"></script>
    <script type="text/javascript" src="models/predator_prey_shodor.js"></script>
    <script type="text/javascript" src="models/conceptual_model1.js"></script>

    <!-- The widgets used in this page -->
	<script type="text/javascript" src="systo_widgets/jquery.runcontrol.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.slider1.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.multiple_sliders1.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.load_language.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.load_model.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.diagram.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.plotter.js"></script>
	<script type="text/javascript" src="systo_widgets/jquery.inline_value.js"></script>

    <!-- This page's custom script -->
    <script>
        //var SYSTO = {};

        $(document).ready(function() {
            //$('#dummy1').loadLanguage();
            //$('#dummy2').loadModel();

            generateSimulationFunction(SYSTO.models['miniworld']);

            $('#plotter1').plotter({
                model: 'miniworld',
                canvasWidth:400, 
                canvasHeight:250,
                selectNode:function (node) {
                    var nodesToPlot = {Population:true};
                    if (nodesToPlot[node.label]) {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#plotter2').plotter({
                model: 'miniworld',
                canvasWidth:300, 
                canvasHeight:200,
                selectNode:function (node) {
                    var nodesToPlot = {Environ_pollution:true};
                    if (nodesToPlot[node.label]) {
                        return true;
                    } else {
                        return false;
                    }
                }
            });
            // TODO: find out why zoom buttons appear only in correct position when ".resizable()" is added.  
            // When it's not add, the buttons are at the top-left of the window!  Seems very odd.
            $('#diagram1').diagram({model:'miniworld', canvasWidth:400, canvasHeight:250, scale:1.5, offsetx:-400, offsety:-300, allowEditing:true}).resizable();
            $('#diagram2').diagram({model:'miniworld'}).
                resizable();
            $('#diagram3').diagram({model:'predator_prey_shodor', canvasWidth:500, canvasHeight:300, scale:0.9});
            $('#diagram4').diagram({model:'conceptual_modelling1', canvasWidth:570, canvasHeight:310, scale:0.7}).
                resizable();

            $('#sliders_initialstock').multiplesliders1({
                model:'miniworld',
                selectNode:function (node) {
                    if (node.type === 'stock') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#sliders_parameter').multiplesliders1({
                model:'miniworld',
                selectNode:function (node) {
                    if (node.type === 'variable') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#sliders_parameter').multiplesliders1('addNode','valve2');
            
            console.debug('-------------- addNode');
            $('#plotter2').plotter('addNode','stock5');

            $('#inline_value1').inlineValue({model:'miniworld', nodeId:'stock1', statistic:'final'});

            //var result = $('#sliders_parameter').multiplesliders1('meta');
            //console.debug(results);
         });
    </script>
</head>

<body>
    <h2>My model</h2>
    <p><b>Description</b><br/>This is some text about my model</p>
    <p>The final value for Population is <span id="inline_value1"></span>.</p>
    <div id='plotter1' style="float:left; border:2px solid red; margin:1px; width:400px; height:300px;"></div>
    <div id='plotter2' style="float:left; border:2px solid red; margin:1px; width:300px; height:220px;"></div>
    <div id="sliders_initialstock" style="float:left; border:2px solid orange; padding:7px; margin:1px; width:420px;"></div>
    <div id="sliders_parameter" style="float:left; border:2px solid orange; padding:7px; margin:1px; width:420px;"></div>
    <div id="diagram1" style="float:left; border:2px solid blue; margin:1px; width:400px; height:250px;"></div>
    <div id="diagram2" style="float:left; border:2px solid blue; margin:1px; width:700px; height:400px;"></div>
    <div id="diagram3" style="float:left; border:2px solid blue; margin:1px; width:500px; height:300px;"></div>
    <div id='plotter2' style="float:left; border:2px solid red; margin:1px; width:300px; height:220px;"></div>
    <div id="diagram4" style="float:left; border:2px solid blue; margin:1px; width:570px; height:310px;"></div>
    <div id="runcontrol" style="float:left; border:2px solid green; margin:1px; width:320px; height:200px;"></div>
    <div id='dummy1'></div>
    <div id='dummy2'></div>
</body>
</html>


