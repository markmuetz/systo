<html>
<head>
    <title>Systo demo: Miniworld</title>
    <!-- CSS -->
    <link type="text/css" rel="stylesheet" href="http://www.systo.org/jquery-ui.css"/>
    <link type="text/css" rel="stylesheet" href="http://www.systo.org/jquery-ui-1.9.2.custom.css"/>

    <!-- Systo core - defines the SYSTO global variable and some core functions -->
    <script type="text/javascript" src="http://www.systo.org/systo.js"></script>

    <!-- Core libraries -->
    <script type="text/javascript" src="http://www.systo.org/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="http://www.systo.org/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://www.systo.org/jquery-ui-1.8.23.custom.min.js"></script>
    <script type="text/javascript" src="http://www.systo.org/formatting.js"></script>
    <script type="text/javascript" src="http://www.systo.org/action.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.ui.widget.js"></script>

    <!-- Supplementary Systo code -->
    <script type="text/javascript" src="http://www.systo.org/generate_simulation_code.js"></script>
    <script type="text/javascript" src="http://www.systo.org/action.js"></script>

    <!-- A model language definition, held as a Javascript object literal -->
    <script type="text/javascript" src="http://www.systo.org/languages/system_dynamics.js"></script>

    <!-- Model(s), held as a Javascript object literal -->
    <script type="text/javascript" src="http://www.systo.org/models/miniworld.js"></script>

    <!-- The widgets used in this page -->
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.runcontrol.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.slider1.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.multiple_sliders1.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.load_language.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.load_model.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.diagram.js"></script>
    <!--script type="text/javascript" src="http://www.systo.org/http://www.myexperiment.org/files/1025/versions/1/download/jquery.diagram.js"></script-->
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.plotter.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.inline_value.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.equation_listing.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.node_dialog_system_dynamics.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.audio_plotter.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.text_plotter.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.phase_plane.js"></script>
	<script type="text/javascript" src="http://www.systo.org/systo_widgets/jquery.table.js"></script>

</head>

<body id="body" style="font-family:arial,sans-serif;">
    <h2>Hartmut Bossel's Miniworld model</h2>
    <h3>Model description</h3>
    <p>This description is taken from the original documentation.   The model diagram is shown below.</p>
    <p>The model has the three state variables (stocks): <b>population</b>, <b>environmental pollution</b>, and <b>production capacity</b> (all standardized to an initial value of 1).</p>
    <p>The population increases by births and is reduced by deaths. The number of births per year depends on the size of the population, the birth rate, and a birth control parameter. It is also affected by the consumption level and by the quality of environment.<p>
    <div id="diagram2" style="float:left; margin:1px; width:700px; height:400px; margin-right:20px; border:solid 1px gray"></div>

<p>The respective environmental pollution arises from the interplay of environmental degradation and regeneration. The amount of degradation depends on population, its consumption level and the specific degradation rate. Regeneration is determined by the specific regeneration rate, the damage threshold, the quality of environment and current environmental pollution. The quality of environment is all the higher the smaller the environmental pollution is in relation to the damage threshold. If the environmental pollution exceeds the damage threshold (quality of environment less than 1), then the regeneration mechanism of environmental pollution changes: the regeneration rate no longer corresponds to existing environmental pollution but to the (smaller) value of the damage threshold. </p>

<p>The level of production capacity changes by the capacity increase rate. This depends with a logistic saturation function on consumption level that in turn corresponds to available production capacity. The capacity increase corresponds to the parameters growth rate and consumption goal; it is also affected by environmental pollution. </p>

    <h3 style="clear:both;">Running the model</h3>
    <p>To explore the behaviour of the model, simply move the sliders for the initial stock value or the parameter value, and the graphs will be updated.</p>

    <h3>Results</h3>
    <p>The final value for Population is <span id="inline_value1"></span>.    The maximum value for Environmental pollution is <span id="inline_value2"></span> and occurred at time <span id="inline_value3"></span>.</p>

    <div style="float:left;">
        <p>Plot of population against time</p>
        <div id='plotter1' style="margin:1px; width:400px; height:300px;"></div>
    </div>
    <div style="float:left;">
        <p>Plot of Environmental pollution (black) and Production capacity (red) against time</p>
        <div id='plotter2' style=" margin:1px; width:400px; height:300px;"></div>
    </div>

    <div id='audio_plotter' style="clear:both; margin:1px; padding:20px;  background:yellow; border:solid 1px #e0e0e0; width:160px;"></div>

    <div style="float:left;">
        <div style="float:left;">
            <span>Sliders for setting the initial value for the 3 stocks</span>
            <div id="sliders_initialstock" style="padding:7px; margin:1px; width:420px;"></div>
        </div>
        <p>&nbsp;</p>
        <div style="clear:left;">
            <span>Sliders for setting two of the parameter values</span>
            <div id="sliders_parameter" style="padding:7px; margin:1px; width:420px;"></div>
        </div>
       <p>&nbsp;</p>
       <p>&nbsp;</p>
    </div>

    <h3 style="clear:both;">Text plotter</h3>
    <div id="text_plotter" style="clear:left; float:left; width:500px; margin:10px;  background:white; border:solid 1px #c0c0c0;"></div>
    <div id="phase_plane" style="float:left; width:400px; height:400px; margin:10px;  background:white; border:solid 1px #c0c0c0;"></div>
    <div id="table" style="float:left; margin:10px;  background:white; border:solid 1px #c0c0c0;"></div>

    <h3 style="clear:both;">Equations</h3>
    <div id="equation_listing"></div>

    <h3 style="clear:left;">Source</h3>
    <p>This model is a Systo re-implementation of the Miniworld model (model Z605) presented in Bossel, H. (2007). System zoo: 3. Norderstedt: Books on Demand GmbH, p. 116-124.</p>
    <p><a href="http://books.google.co.uk/books?id=B0XBF6GliVgC&pg=PA116&source=gbs_toc_r&cad=4">This link</a> provides a partial preview of the chapter describing the model.</p>
    <!--div id="node_dialog_system_dynamics" style="display:block; position:absolute; width:400px; height:100px; left:100px; top:100px; font-size:16px; background:yellow; border:solid 1px black; padding:20px;">abc</div-->

    <div id="node_dialogs"></div>


    <!-- This page's custom script -->
    <script>

        $(document).ready(function() {

            generateSimulationFunction(SYSTO.models['miniworld']);

            $('#plotter1').plotter({
                model:'miniworld',
                canvasWidth:400, 
                canvasHeight:250,
                selectNode:function (node) {
                    var nodesToPlot = {Population:true};
                    if (nodesToPlot[node.label]) {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#plotter2').plotter({
                model:'miniworld',
                canvasWidth:400, 
                canvasHeight:250,
                selectNode:function (node) {
                    var nodesToPlot = {Environ_pollution:true,Production_capacity:true};
                    if (nodesToPlot[node.label]) {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#audio_plotter').audio_plotter({
                modelId:'miniworld',
                includeNodeId: function(nodeId) {
                    var node = SYSTO.models['miniworld'].nodes[nodeId];
                    if (node.type === 'stock') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#text_plotter').text_plotter({modelId:'miniworld'});
            $('#phase_plane').phase_plane({modelId:'miniworld', xnodeId:'stock1', ynodeId:'stock3'});

            $('#table').table({
                modelId:'miniworld',
                every:5
            });

            $('#diagram2').diagram({model:'miniworld', allowEditing:true});
            $('#diagram2').resizable();

            $('#sliders_initialstock').multiplesliders1({
                model:'miniworld',
                selectNode:function (node) {
                    if (node.type === 'stock') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#sliders_parameter').multiplesliders1({
                model:'miniworld',
                selectNode:function (node) {
                    if (node.label==='birth_rate' || node.label==='regeneration_rate') {
                        return true;
                    } else {
                        return false;
                    }
                }
            });

            $('#inline_value1').inlineValue({model:'miniworld', nodeId:'stock1', statistic:'final'});
            $('#inline_value2').inlineValue({model:'miniworld', nodeId:'stock3', statistic:'max'});
            $('#inline_value3').inlineValue({model:'miniworld', nodeId:'stock3', statistic:'maxtime'});

            $('#equation_listing').equation_listing({model:'miniworld'});

            //$('#node_dialog_system_dynamics').node_dialog_system_dynamics({model:'miniworld'});
            $('#node_dialogs').append(SYSTO.node_dialogs.system_dynamics);


         });
    </script>
</body>
</html>



